<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" data-whc_version="24.1">
    <head><link rel="shortcut icon" href="oxygen-webhelp\template\resources/images/favicon.ico"/><link rel="icon" href="oxygen-webhelp\template\resources/images/favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="Before using any BLE Stack relevant API, BLE component must be initialized. It is strongly recommend that BLE component be initialized during system initialization. BLE component only operates with ..."/><meta name="copyright" content="(C) Copyright 2024"/><meta name="generator" content="DITA-OT"/><title>1.2.1.1 Initializing the BLE Software</title><!--  Generated with Oxygen version 24.1, build number 2022062014.  --><meta name="wh-path2root" content=""/><meta name="wh-toc-id" content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;?workdir /D:\InfoShare\Data\Publish\Data\mnxeugsprob\work\temp?&gt;&lt;?workdir-uri file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/temp/?&gt;&lt;?path2project?&gt;&lt;?path2project-uri ./?&gt;&lt;?path2rootmap-uri ./?&gt;&lt;topic xmlns:dita-ot=&#34;http://dita-ot.sourceforge.net/ns/201007/dita-ot&#34; xmlns:ditaarch=&#34;http://dita.oasis-open.org/architecture/2005/&#34; class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;initializing-the-ble-software&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;topic:1;184:15&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;title:1;184:15&#34;&gt;Initializing the BLE Software&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;body:1;184:15&#34;/&gt;&lt;related-links class=&#34;- topic/related-links &#34;&gt;&lt;linkpool class=&#34;- topic/linkpool &#34; mapkeyref=&#34;GUID-24032B9A-02CD-4AB8-BAD8-7DDB234DE7EA&#34; xtrc=&#34;topicref:969;6:152684&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-24032B9A-02CD-4AB8-BAD8-7DDB234DE7EA.ditamap&#34;&gt;&lt;link class=&#34;- topic/link &#34; format=&#34;dita&#34; href=&#34;GUID-222749FE-01C5-43B6-A5C7-CD82B3FC7F5F.xml&#34; mapclass=&#34;- map/topicref &#34; role=&#34;parent&#34; scope=&#34;local&#34; type=&#34;topic&#34; xtrc=&#34;topicref:968;6:152538&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-24032B9A-02CD-4AB8-BAD8-7DDB234DE7EA.ditamap&#34;&gt;&lt;?ditaot usertext?&gt;&lt;linktext class=&#34;- topic/linktext &#34;&gt;&lt;?ditaot gentext?&gt;BLE Software Specification&lt;/linktext&gt;&lt;?ditaot genshortdesc?&gt;&lt;desc class=&#34;- topic/desc &#34;/&gt;&lt;/link&gt;&lt;/linkpool&gt;&lt;/related-links&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;initializing-ble-stack&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;topic:2;184:15&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;title:2;184:15&#34;&gt;Initializing BLE Stack&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;body:2;184:15&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:1;184:15&#34;&gt;Before using any BLE Stack relevant API, BLE component must be initialized. It is strongly recommend that BLE component be initialized during system initialization. BLE component only operates with RTOS, the relevant parameters of RTOS must be assigned to BLE component. Also, device address is necessary for BLE component.&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;c&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;codeblock:1;184:15&#34;&gt; //BLE Queue definition #define QUEUE_LENGTH_BLE (16) #define QUEUE_ITEM_SIZE_BLE (sizeof(void *)) //BLE library Initialization Data OSAL_QUEUE_HANDLE_TYPE bleRequestQueueHandle; OSAL_API_LIST_TYPE osalAPIList; uint8_t bdAddr[7]; //address type + address[6] // Create BLE Stack Message QUEUE OSAL_QUEUE_Create(&amp;amp;bleRequestQueueHandle, QUEUE_LENGTH_BLE, QUEUE_ITEM_SIZE_BLE); // Initialize BLE Stack if(IB_GetBdAddr(bdAddr) == 0) { BT_SYS_Init(&amp;amp;bleRequestQueueHandle, &amp;amp;osalAPIList, NULL, bdAddr); } else { BT_SYS_Init(&amp;amp;bleRequestQueueHandle, &amp;amp;osalAPIList, NULL, NULL); }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:2;184:15&#34;&gt;BLE Stack provides various APIs for application, and those APIs belong to the specific module within dedicated group. Currently there are four groups inside the BLE Stack. Application shall initialize the dedicated group and modules in the BLE Stack if needs.&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;ul:1;184:15&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;li:1;184:15&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:3;184:15&#34;&gt;GAP: Provide the user interface for discovery of BLE devices, broadcast of BLE device, and connection management&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;li:2;184:15&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:4;184:15&#34;&gt;L2CAP: Provide the user interface for credit based flow control procedure&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;li:3;184:15&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:5;184:15&#34;&gt;GATT: Provide the user interface for GATT server and client procedure&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;li:4;184:15&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:6;184:15&#34;&gt;SMP: Provide the user interface for pairing, authentication, and security configuration&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:7;184:15&#34;&gt;Example of initializing modules in GAP group:&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;c&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;codeblock:2;184:15&#34;&gt; //Initialize BLE GAP main module BLE_GAP_Init(); //Initialize BLE GAP advertising module BLE_GAP_AdvInit(); &lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:8;184:15&#34;&gt;Example of initializing modules in L2CAP group:&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;c&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;codeblock:3;184:15&#34;&gt; //Initialize BLE L2cap main module BLE_L2CAP_Init(); //Initialize BLE L2cap credit based flow control module BLE_L2CAP_CbInit();&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:9;184:15&#34;&gt;Example of initializing modules in GATT group:&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;c&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;codeblock:4;184:15&#34;&gt; //Initialize BLE GATT server module GATTS_Init(); //Initialize BLE GATT client module GATTC_Init(); &lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:10;184:15&#34;&gt;Example of initializing modules in SMP group:&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;c&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;codeblock:5;184:15&#34;&gt; //Initialize BLE SMP main module BLE_SMP_Init(); &lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:11;184:15&#34;&gt;BLE Stack would generate events to inform application if there is any status changed or activity. Application may need to get the relevant information from BLE Stack and do the corresponding procedure. Therefore, application shall register BLE Stack callback function after BLE Stack initialized.&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:12;184:15&#34;&gt;Example of registering BLE Stack callback event:&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;c&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;codeblock:6;184:15&#34;&gt; /* Register BLE Stack callback event*/ STACK_EventRegister(APP_BleStackCb);&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;initializing-ble-middleware&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;topic:3;184:15&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;title:3;184:15&#34;&gt;Initializing BLE Middleware&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;body:3;184:15&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:13;184:15&#34;&gt;BLE component provides two modules in BLE Middleware to assist application. Application shall initialize the dedicated modules if needs.&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;ul:2;184:15&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;li:5;184:15&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:14;184:15&#34;&gt;BLE_DM: Handle pairing procedures, connection management and the record of pairing information. Provide the simplified user interface for application.&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;li:6;184:15&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:15;184:15&#34;&gt;BLE_DD: Handle the service discovery procedures. It shall be included if a GATT client profile is enabled.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:16;184:15&#34;&gt;Example of initializing modules in BLE Middleware:&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;c&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;codeblock:7;184:15&#34;&gt; //Initialize BLE device manager module BLE_DM_Init(); //Initialize BLE device discovery module BLE_DD_Init();&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:17;184:15&#34;&gt;BLE Middleware module would generate events to inform application if there is any status changed or activity. Application may need to get the relevant information from BLE Middleware and do the corresponding procedure. Therefore, application shall register BLE Middleware callback function after BLE Middleware initialized.&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:18;184:15&#34;&gt;Example of registering BLE middleware callback event:&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;c&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;codeblock:8;184:15&#34;&gt; /* Register BLE DM module callback event */ BLE_DM_EventRegister(APP_DmEvtHandler); /* Register BLE DD module callback event */ BLE_DD_EventRegister(APP_DdEvtHandler);&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;initializing-ble-profile&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;topic:4;184:15&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;title:4;184:15&#34;&gt;Initializing BLE Profile&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;body:4;184:15&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:19;184:15&#34;&gt;BLE component provides some example profiles. Application shall initialize the profiles if needs.&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:20;184:15&#34;&gt;Example of initializing BLE profiles:&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;c&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;codeblock:9;184:15&#34;&gt; //Initialize BLE transparent server profile BLE_TRSPS_Init(); //Initialize BLE transparent client profile BLE_TRSPC_Init();&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:21;184:15&#34;&gt;BLE profiles module would generate events to inform application if there is any status changed or activity. Application may need to get the relevant information from BLE profiles and do the corresponding procedure. Therefore, application shall register BLE profiles callback function after BLE profiles initialized.&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:22;184:15&#34;&gt;Example of registering BLE profiles callback event:&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;c&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;codeblock:10;184:15&#34;&gt; /* Register BLE transparent server callback event */ BLE_TRSPS_EventRegistration(APP_TrspsEvtHandler); /* Register BLE transparent client callback event */ BLE_TRSPC_EventRegistration(APP_TrspcEvtHandler);&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;initializing-ble-service&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;topic:5;184:15&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;title:5;184:15&#34;&gt;Initializing BLE Service&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;body:5;184:15&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:23;184:15&#34;&gt;BLE component provides some example services. Some of the services are used by the specific profile, and some of them may be used by application directly.&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;p:24;184:15&#34;&gt;Example of initializing BLE service:&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;c&#34; xtrf=&#34;file:/D:/InfoShare/Data/Publish/Data/mnxeugsprob/work/3/en-US/GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md&#34; xtrc=&#34;codeblock:11;184:15&#34;&gt; //Initialize BLE device information service BLE_DIS_Add(); //Initialize BLE battery service BLE_BAS_Add();&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;"/><meta name="wh-source-relpath" content="GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.md"/><meta name="wh-out-relpath" content="GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.html"/>
    <!-- Latest compiled and minified Bootstrap CSS -->
    <link rel="stylesheet" type="text/css" href="./oxygen-webhelp/lib/bootstrap/css/bootstrap.min.css"/>
    
    <link rel="stylesheet" href="./oxygen-webhelp/lib/jquery-ui/jquery-ui.min.css"/>
    
    <!-- Template default styles  -->
    <link rel="stylesheet" type="text/css" href="./oxygen-webhelp/app/topic-page.css?buildId=2022062014"/>
    
    
    <script src="./oxygen-webhelp/lib/jquery/jquery-3.5.1.min.js"></script>
    
    <script data-main="./oxygen-webhelp/app/topic-page.js" src="./oxygen-webhelp/lib/requirejs/require.js"></script>
<link rel="stylesheet" type="text/css" href="oxygen-webhelp/template/microchip.css?buildId=2022062014"/><link rel="stylesheet" type="text/css" href="oxygen-webhelp/template/notes.css?buildId=2022062014"/>
<script src="mchp-context-help.js"></script>
<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,300" rel="stylesheet" type="text/css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async="" type="text/javascript"></script>
    <script src="https://assets.adobedtm.com/6a72a357eb48/a636c708c7fe/launch-0b0023397020.min.js"></script><!-- Adobe Analytics -->
</head>

    <body id="initializing-the-ble-software" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            Jump to main content
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="index.html" class=" wh_logo d-none d-sm-block "><img src="oxygen-webhelp\template\resources/images/microchip.png" alt="MPLAB Harmony Wireless BLE &#xA;    "/></a>
                    <div class=" wh_publication_title "><a href="index.html">MPLAB Harmony Wireless BLE 
    </a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        </div>
    </div>
</header>
        
        
         
        
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="search.html"><div class="d-flex justify-contents-around"><div class="flex-grow-1"></div><div class="position-relative flex-grow-1"><input type="search" placeholder="Search " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="Search query" required="required"/><button type="submit" class="wh_search_button" aria-label="Search"><span class="search_input_text">Search</span></button></div><div class="align-self-center flex-grow-1 ml-2"><div class="d-flex justify-content-end"><div class="dropdown"><a style="font-size: 1em; padding: 7px 12px !important;" class="btn py-3 px-3 btn-outline-light dropdown-toggle" href="#" role="button" id="devicesMenu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Product Pages</a><div style="font-size: 1em;" class="dropdown-menu" aria-labelledby="devicesMenu"><a class="dropdown-item" target="_blank" href="https://www.microchip.com/en-us/product/pic32cx-bz2">PIC32CX-BZ2</a><a class="dropdown-item" target="_blank" href="https://www.microchip.com/en-us/product/wbz450"> WBZ450</a><a class="dropdown-item" target="_blank" href="https://www.microchip.com/en-us/product/wbz451"> WBZ451</a><a class="dropdown-item" target="_blank" href="https://www.microchip.com/en-us/product/pic32cx-bz3"> PIC32CX-BZ3</a><a class="dropdown-item" target="_blank" href="https://www.microchip.com/en-us/product/wbz350"> WBZ350</a><a class="dropdown-item" target="_blank" href="https://www.microchip.com/en-us/product/wbz351"> WBZ351</a></div></div></div></div></div></form>
            
            <div class="mchp-color-stripe-grid-container">
  <div class="mchp-main-bar mchp-orange-bar"></div>
  <div class="mchp-main-bar mchp-blue-bar"></div>
  <div class="mchp-main-bar mchp-green-bar"></div>
</div>
            
        </div>
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="index.html"><span>Home</span></a></span></li><li><div class="topicref" data-id="GUID-1DE7F398-A485-4143-964B-2CB21E5F4B26"><div class="title"><a href="GUID-1DE7F398-A485-4143-964B-2CB21E5F4B26.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1</ph>
BLE Software</a><div class="wh-tooltip"><p class="shortdesc"></p></div></div></div></li><li><div class="topicref" data-id="GUID-CFC8AE9F-F620-4D4D-9665-E08FFE0763EB"><div class="title"><a href="GUID-CFC8AE9F-F620-4D4D-9665-E08FFE0763EB.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1.2</ph>
Wireless BLE v1.2</a><div class="wh-tooltip"><p class="shortdesc"></p></div></div></div></li><li><div class="topicref" data-id="GUID-222749FE-01C5-43B6-A5C7-CD82B3FC7F5F"><div class="title"><a href="GUID-222749FE-01C5-43B6-A5C7-CD82B3FC7F5F.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1.2.1</ph>
BLE Software Specification</a><div class="wh-tooltip"><p class="shortdesc"></p></div></div></div></li><li class="active"><div class="topicref" data-id="initializing-the-ble-software"><div class="title"><a href="GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1.2.1.1</ph>
Initializing the BLE Software</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="Toggle search highlights" title="Toggle search highlights"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="Collapse sections" title="Collapse sections"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            <div class="row" style="margin-top: -1em;"><div class="col-lg-7 col-md-7 col-sm-12 offset-lg-3 offset-md-3 text-right border-bottom mb-1"><h2 class="text-dark header_title">
    </h2></div></div>
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem" aria-expanded="true"><div data-tocid="GUID-1DE7F398-A485-4143-964B-2CB21E5F4B26-d13878e11" class="topicref" data-id="GUID-1DE7F398-A485-4143-964B-2CB21E5F4B26" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action GUID-1DE7F398-A485-4143-964B-2CB21E5F4B26-d13878e11-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-1DE7F398-A485-4143-964B-2CB21E5F4B26.html" id="GUID-1DE7F398-A485-4143-964B-2CB21E5F4B26-d13878e11-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1</ph>
BLE Software</a><div class="wh-tooltip"><p class="shortdesc"></p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-1F6AF334-EDDF-4C37-8BAE-9B246FD37EE5-d13878e21" class="topicref" data-id="GUID-1F6AF334-EDDF-4C37-8BAE-9B246FD37EE5" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-1F6AF334-EDDF-4C37-8BAE-9B246FD37EE5-d13878e21-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-1F6AF334-EDDF-4C37-8BAE-9B246FD37EE5.html" id="GUID-1F6AF334-EDDF-4C37-8BAE-9B246FD37EE5-d13878e21-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1.1</ph>
Wireless BLE v1.3</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="GUID-CFC8AE9F-F620-4D4D-9665-E08FFE0763EB-d13878e8169" class="topicref" data-id="GUID-CFC8AE9F-F620-4D4D-9665-E08FFE0763EB" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action GUID-CFC8AE9F-F620-4D4D-9665-E08FFE0763EB-d13878e8169-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-CFC8AE9F-F620-4D4D-9665-E08FFE0763EB.html" id="GUID-CFC8AE9F-F620-4D4D-9665-E08FFE0763EB-d13878e8169-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1.2</ph>
Wireless BLE v1.2</a><div class="wh-tooltip"><p class="shortdesc"></p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="true"><div data-tocid="GUID-222749FE-01C5-43B6-A5C7-CD82B3FC7F5F-d13878e8179" class="topicref" data-id="GUID-222749FE-01C5-43B6-A5C7-CD82B3FC7F5F" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action GUID-222749FE-01C5-43B6-A5C7-CD82B3FC7F5F-d13878e8179-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-222749FE-01C5-43B6-A5C7-CD82B3FC7F5F.html" id="GUID-222749FE-01C5-43B6-A5C7-CD82B3FC7F5F-d13878e8179-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1.2.1</ph>
BLE Software Specification</a><div class="wh-tooltip"><p class="shortdesc"></p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" class="active"><div data-tocid="initializing-the-ble-software-d13878e8189" class="topicref" data-id="initializing-the-ble-software" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-94489357-3C47-427B-84D1-73FC2ACC68FA.html" id="initializing-the-ble-software-d13878e8189-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1.2.1.1</ph>
Initializing the BLE Software</a></div></div></li><li role="treeitem"><div data-tocid="using-the-ble-software-d13878e8197" class="topicref" data-id="using-the-ble-software" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-9FB92A59-EC4A-4262-888E-E0B0651D0F34.html" id="using-the-ble-software-d13878e8197-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1.2.1.2</ph>
Using the BLE Software</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-7A484789-9F5E-4C59-81A1-F64D44E59F67-d13878e8205" class="topicref" data-id="GUID-7A484789-9F5E-4C59-81A1-F64D44E59F67" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-7A484789-9F5E-4C59-81A1-F64D44E59F67-d13878e8205-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-7A484789-9F5E-4C59-81A1-F64D44E59F67.html" id="GUID-7A484789-9F5E-4C59-81A1-F64D44E59F67-d13878e8205-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1.2.1.3</ph>
BLE Memory Usage</a><div class="wh-tooltip"><p class="shortdesc"></p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-C76FA981-3CAC-4973-AE4F-8FFEE405F570-d13878e8231" class="topicref" data-id="GUID-C76FA981-3CAC-4973-AE4F-8FFEE405F570" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-C76FA981-3CAC-4973-AE4F-8FFEE405F570-d13878e8231-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-C76FA981-3CAC-4973-AE4F-8FFEE405F570.html" id="GUID-C76FA981-3CAC-4973-AE4F-8FFEE405F570-d13878e8231-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1.2.1.4</ph>
BLE PTA</a><div class="wh-tooltip"><p class="shortdesc"></p></div></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-9227C855-DF4C-4541-9FE1-2608FF954E43-d13878e8281" class="topicref" data-id="GUID-9227C855-DF4C-4541-9FE1-2608FF954E43" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-9227C855-DF4C-4541-9FE1-2608FF954E43-d13878e8281-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-9227C855-DF4C-4541-9FE1-2608FF954E43.html" id="GUID-9227C855-DF4C-4541-9FE1-2608FF954E43-d13878e8281-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1.2.2</ph>
BLE Software API</a><div class="wh-tooltip"><p class="shortdesc"></p></div></div></div></li></ul></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-BDEB1D88-52CC-42E2-AA49-89B9BA4DBDAE-d13878e16300" class="topicref" data-id="GUID-BDEB1D88-52CC-42E2-AA49-89B9BA4DBDAE" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-BDEB1D88-52CC-42E2-AA49-89B9BA4DBDAE-d13878e16300-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-BDEB1D88-52CC-42E2-AA49-89B9BA4DBDAE.html" id="GUID-BDEB1D88-52CC-42E2-AA49-89B9BA4DBDAE-d13878e16300-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2</ph>
BLE Document</a><div class="wh-tooltip"><p class="shortdesc"></p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d13878e17723" class="topicref backmatter backmatter_parent" data-id="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d13878e17723-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B.html" id="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d13878e17723-link">Microchip Information</a></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article role="article" aria-labelledby="ariaid-title1"><h1 class="- topic/title title topictitle1" id="ariaid-title1" style="">1.2.1.1 Initializing the BLE Software</h1><div class="- topic/body body"></div><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title2" id="initializing-ble-stack"><h2 class="- topic/title title topictitle2" id="ariaid-title2" style=""> Initializing BLE Stack</h2><div class="- topic/body body"><p class="- topic/p p">Before using any BLE Stack relevant API, BLE component must be initialized.
It is strongly recommend that BLE component be initialized during system initialization.
BLE component only operates with RTOS, the relevant parameters of RTOS must be assigned to BLE component.
Also, device address is necessary for BLE component.</p><pre class="+ topic/pre pr-d/codeblock pre codeblock c">    <em class="hl-comment">//BLE Queue definition</em>
    <span class="hl-directive">#define</span> <span class="hl-defines">QUEUE_LENGTH_BLE</span> (<span class="hl-number">16</span>)
    <span class="hl-directive">#define</span> <span class="hl-defines">QUEUE_ITEM_SIZE_BLE</span> (<strong class="hl-keyword">sizeof</strong>(<strong class="hl-keyword">void</strong> *))

    <em class="hl-comment">//BLE library Initialization Data</em>
    OSAL_QUEUE_HANDLE_TYPE bleRequestQueueHandle;
    OSAL_API_LIST_TYPE     osalAPIList;
    uint8_t                bdAddr[<span class="hl-number">7</span>];     <em class="hl-comment">//address type + address[6]</em>

    <em class="hl-comment">// Create BLE Stack Message QUEUE</em>
    OSAL_QUEUE_Create(&amp;bleRequestQueueHandle, QUEUE_LENGTH_BLE, QUEUE_ITEM_SIZE_BLE);

    <em class="hl-comment">// Initialize BLE Stack</em>
    <strong class="hl-keyword">if</strong>(IB_GetBdAddr(bdAddr) == <span class="hl-number">0</span>)
    {
        BT_SYS_Init(&amp;bleRequestQueueHandle, &amp;osalAPIList, NULL, bdAddr);
    }
    <strong class="hl-keyword">else</strong>
    {
        BT_SYS_Init(&amp;bleRequestQueueHandle, &amp;osalAPIList, NULL, NULL);
    }</pre><p class="- topic/p p">BLE Stack provides various APIs for application, and those APIs belong to the specific module within dedicated group.
Currently there are four groups inside the BLE Stack.
Application shall initialize the dedicated group and modules in the BLE Stack if needs.</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">GAP: Provide the user interface for discovery of BLE devices, broadcast of BLE device, and connection management</p></li><li class="- topic/li li"><p class="- topic/p p">L2CAP: Provide the user interface for credit based flow control procedure</p></li><li class="- topic/li li"><p class="- topic/p p">GATT: Provide the user interface for GATT server and client procedure</p></li><li class="- topic/li li"><p class="- topic/p p">SMP: Provide the user interface for pairing, authentication, and security configuration</p></li></ul><p class="- topic/p p">Example of initializing modules in GAP group:</p><pre class="+ topic/pre pr-d/codeblock pre codeblock c">    <em class="hl-comment">//Initialize BLE GAP main module</em>
    BLE_GAP_Init();
    
    <em class="hl-comment">//Initialize BLE GAP advertising module</em>
    BLE_GAP_AdvInit();
</pre><p class="- topic/p p">Example of initializing modules in L2CAP group:</p><pre class="+ topic/pre pr-d/codeblock pre codeblock c">    <em class="hl-comment">//Initialize BLE L2cap main module</em>
    BLE_L2CAP_Init();

    <em class="hl-comment">//Initialize BLE L2cap credit based flow control module</em>
    BLE_L2CAP_CbInit();</pre><p class="- topic/p p">Example of initializing modules in GATT group:</p><pre class="+ topic/pre pr-d/codeblock pre codeblock c">    <em class="hl-comment">//Initialize BLE GATT server module</em>
    GATTS_Init();

    <em class="hl-comment">//Initialize BLE GATT client module</em>
    GATTC_Init();
</pre><p class="- topic/p p">Example of initializing modules in SMP group:</p><pre class="+ topic/pre pr-d/codeblock pre codeblock c">    <em class="hl-comment">//Initialize BLE SMP main module</em>
    BLE_SMP_Init();
</pre><p class="- topic/p p">BLE Stack would generate events to inform application if there is any status changed or activity.
Application may need to get the relevant information from BLE Stack and do the corresponding procedure.
Therefore, application shall register BLE Stack callback function after BLE Stack initialized.</p><p class="- topic/p p">Example of registering BLE Stack callback event:</p><pre class="+ topic/pre pr-d/codeblock pre codeblock c">    <em class="hl-comment">/* Register BLE Stack callback event*/</em>
    STACK_EventRegister(APP_BleStackCb);</pre></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title3" id="initializing-ble-middleware"><h2 class="- topic/title title topictitle2" id="ariaid-title3" style=""> Initializing BLE Middleware</h2><div class="- topic/body body"><p class="- topic/p p">BLE component provides two modules in BLE Middleware to assist application.
Application shall initialize the dedicated modules if needs.</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">BLE_DM: Handle pairing procedures, connection management and the record of pairing information. Provide the simplified user interface for application.</p></li><li class="- topic/li li"><p class="- topic/p p">BLE_DD: Handle the service discovery procedures. It shall be included if a GATT client profile is enabled.</p></li></ul><p class="- topic/p p">Example of initializing modules in BLE Middleware:</p><pre class="+ topic/pre pr-d/codeblock pre codeblock c">    <em class="hl-comment">//Initialize BLE device manager module</em>
    BLE_DM_Init();

    <em class="hl-comment">//Initialize BLE device discovery module</em>
    BLE_DD_Init();</pre><p class="- topic/p p">BLE Middleware module would generate events to inform application if there is any status changed or activity.
Application may need to get the relevant information from BLE Middleware and do the corresponding procedure.
Therefore, application shall register BLE Middleware callback function after BLE Middleware initialized.</p><p class="- topic/p p">Example of registering BLE middleware callback event:</p><pre class="+ topic/pre pr-d/codeblock pre codeblock c">    <em class="hl-comment">/* Register BLE DM module callback event */</em>
    BLE_DM_EventRegister(APP_DmEvtHandler);

    <em class="hl-comment">/* Register BLE DD module callback event */</em>
    BLE_DD_EventRegister(APP_DdEvtHandler);</pre></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title4" id="initializing-ble-profile"><h2 class="- topic/title title topictitle2" id="ariaid-title4" style=""> Initializing BLE Profile</h2><div class="- topic/body body"><p class="- topic/p p">BLE component provides some example profiles.
Application shall initialize the profiles if needs.</p><p class="- topic/p p">Example of initializing BLE profiles:</p><pre class="+ topic/pre pr-d/codeblock pre codeblock c">    <em class="hl-comment">//Initialize BLE transparent server profile</em>
    BLE_TRSPS_Init();

    <em class="hl-comment">//Initialize BLE transparent client profile</em>
    BLE_TRSPC_Init();</pre><p class="- topic/p p">BLE profiles module would generate events to inform application if there is any status changed or activity.
Application may need to get the relevant information from BLE profiles and do the corresponding procedure.
Therefore, application shall register BLE profiles callback function after BLE profiles initialized.</p><p class="- topic/p p">Example of registering BLE profiles callback event:</p><pre class="+ topic/pre pr-d/codeblock pre codeblock c">    <em class="hl-comment">/* Register BLE transparent server callback event */</em>
    BLE_TRSPS_EventRegistration(APP_TrspsEvtHandler);

    <em class="hl-comment">/* Register BLE transparent client callback event */</em>
    BLE_TRSPC_EventRegistration(APP_TrspcEvtHandler);</pre></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title5" id="initializing-ble-service"><h2 class="- topic/title title topictitle2" id="ariaid-title5" style=""> Initializing BLE Service</h2><div class="- topic/body body"><p class="- topic/p p">BLE component provides some example services.
Some of the services are used by the specific profile, and some of them may be used by application directly.</p><p class="- topic/p p">Example of initializing BLE service:</p><pre class="+ topic/pre pr-d/codeblock pre codeblock c">    <em class="hl-comment">//Initialize BLE device information service</em>
    BLE_DIS_Add();

    <em class="hl-comment">//Initialize BLE battery service</em>
    BLE_BAS_Add();</pre></div></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">On this page</div><ul><li class="topic-item"><a href="#initializing-ble-stack" data-tocid="initializing-ble-stack"> Initializing BLE Stack</a></li><li class="topic-item"><a href="#initializing-ble-middleware" data-tocid="initializing-ble-middleware"> Initializing BLE Middleware</a></li><li class="topic-item"><a href="#initializing-ble-profile" data-tocid="initializing-ble-profile"> Initializing BLE Profile</a></li><li class="topic-item"><a href="#initializing-ble-service" data-tocid="initializing-ble-service"> Initializing BLE Service</a></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
    <div class="footer">
  <div class="mchp-wh-footer">
    <div class="mchp-footer">
      <div class="mchp-footer-tier1">
        <div class="spacer"></div>
        <div class="mchp-footer-container">
          <div class="mchp-footer-links mchp-social-media-links">
            <div class="mchp-component-items">
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.facebook.com/pages/Microchip-Technology-Inc/20320981741" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Facebook" src="oxygen-webhelp/template/resources/images/201016-corp-facebook.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.linkedin.com/company/microchip-technology" target="_blank">
                  <img class="cmp-image__image" alt="Microchip LinkedIn" src="oxygen-webhelp/template/resources/images/201016-corp-linkedin.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://twitter.com/MicrochipTech" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Twitter" src="oxygen-webhelp/template/resources/images/201016-corp-twitter.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.youtube.com/user/MicrochipTechnology" target="_blank">
                  <img class="cmp-image__image" alt="Microchip YouTube" src="oxygen-webhelp/template/resources/images/201016-corp-youtube.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.instagram.com/microchiptechnologyinc/" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Instagram" src="oxygen-webhelp/template/resources/images/201016-corp-instagram.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.weibo.com/microchiptech" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Weibo" src="oxygen-webhelp/template/resources/images/201016-corp-weibo.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.microchip.com/en-us/about/blog" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Blog" src="oxygen-webhelp/template/resources/images/201016-corp-blog.png"/>
                </a>
              </div>
            </div>
          </div>
          <div class="mchp-footer-links">
            <div class="mchp-component-items">
              <div class="mchp-component-item">
                <div class="link">
                  <a href="https://www.microchip.com/about-us/contact-us" class="mchp-link__link">Contact</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information" class="mchp-link__link">Legal</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information/privacy-policy" class="mchp-link__link">Privacy Policy</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information/microchip-cookie-statement" class="mchp-link__link">Cookies</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item">
                <div class="link">
                  <a href="https://careers.microchip.com/" class="mchp-link__link">Careers</a>
                  <span class="mchp-link__separator"></span>
                </div>
              </div>
            </div>
          </div>
          <div class="mchp-footer-newsletter">
            <div class="cmp-text">
              <p>Stay on the leading edge with our blog</p>
            </div>
            <div class="mchp-button-wrapper">
              <a role="button" href="https://www.microchip.com/en-us/about/blog" class="mchp-button mchp-button-regular solid">
                <span class="mchp-button__span">MicroSolutions</span>
              </a>
            </div>
          </div>
        </div>
        <div class="graphic">
          <img src="oxygen-webhelp/template/resources/images/footer-graphic.png"/>
        </div>
      </div>
      <div class="mchp-footer-tier2">
        <p class="mchp-copyright"> Copyright 1998-2022 Microchip Technology Inc. All rights reserved.</p>
      </div>
    </div>
  </div>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="true" src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-19"></script>
  <script>
    window.dataLayer = window.dataLayer || [];  
    function gtag(){dataLayer.push(arguments);}  
    gtag('js', new Date());   
    gtag('config', 'UA-2724382-19');
  </script>
  
  <script type="text/javascript">_satellite.pageBottom();</script><!-- Adobe Analytics -->
  <script type="text/javascript" src="mchp-js/prepend.js"></script><!-- Package for viewing PDFs on mobile devices -->
  
</div>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
       
        </body>
</html>