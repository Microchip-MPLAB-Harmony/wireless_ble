# Firmware Update Request operation

When the Firmware Update Request opcode is written to the OTACP and an error condition does not<br /> occur, the Server shall start the firmware update procedure.

The format of the Firmware Update Request operation is defined Table 4.3.

<br />

|**Opcode**|**Requirement**|**Size \(octets\)**|**Description**|
|----------|---------------|-------------------|---------------|
|0x02|M|1|Firmware Update Request|
|**Opcode**|**Requirement**|**Size \(octets\)**|**Description**|
|New\_Firmware\_Image\_Size|C.1|4|Size of new firmware image|
|New\_Firmware\_Image\_ID|C.1|4|Identity of new firmware image|
|New\_Firmware\_Image\_Version|C.1|4|Version of new firmware image|
|New\_Firmware\_Image\_Enc\_Method|C.1|1|New firmware image encrypt method 0x00: New<br /> firmware image is not encrypted 0x01: New firmware image is<br /> encrypted by AES CBC|
|New\_Firmware\_Image\_Checksum|C.3|2|Checksum value of new firmware image|
|New\_Firmware\_Image\_File\_Type|C.3|1|File type of new firmware image 0x01: New<br /> firmware image is for eFlash or Stack Flash NVM0x02: New<br /> firmware image pass to application 0x03: New firmware image<br /> is for Ext Flash NVM|
|New\_Firmware\_Image\_CRC16|C.3|2|CRC16 value of new firmware image \(plain text content\)|
|New\_Metadata\_Size|C.1|4|Size of new metadata|

<br />

C.1 Itâ€™s available only when Firmware Image is set supported in Supported\_Image\_Type<br /> field.

C.2 Itâ€™s available only when Metadata is set supported in Supported\_Image\_Type field.

C.3 Itâ€™s available only when Firmware Image is set supported in Supported\_Image\_Type<br /> field and Supported feature mask 1 is set supported in Firmware\_Extended\_Feature<br /> field.

The format of response parameter contained in the response parameter is defined Table<br /> 4.4.

<br />

|**Response Parameter**|**Requirement**|**Size \(octets\)**|**Description**|
|----------------------|---------------|-------------------|---------------|
|Max\_Fragmented\_Image\_Size|M|2|Maximum fragmented image size|
|Image\_Start\_Index|M|4|The start index of image|
|Current\_Firmware\_Image\_Version|C.1|4|Version of current Firmware image|

<br />

C.1 Itâ€™s available only when firmware Image is set supported in Supported\_ Image\_Type<br /> field.

However, if an error condition occurs, the â€œSuccessâ€? result code shall not be sent and<br /> the appropriate error response shall be sent as defined in Table 4.5.

<br />

|**Error Condition**|**Error Response**|
|-------------------|------------------|
|Upper layer rejects update request|Not supported|
|The received data length is invalid|Not supported|
|Image size exceeds max image size|Invalid parameter|
|Active flash head is not available|Operation failed|

<br />

**Parent topic:**[OTA Control Operations](GUID-FA1AB790-BF05-4FBA-B346-9D4CB88158DB.md)

